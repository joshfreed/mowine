//
//  FirstTimeWorker.swift
//  mowine
//
//  Created by Josh Freed on 3/20/18.
//  Copyright (c) 2018 Josh Freed. All rights reserved.
//
//  This file was generated by the Clean Swift Xcode Templates so
//  you can apply clean architecture to your iOS and Mac projects,
//  see http://clean-swift.com
//

import UIKit
import GoogleSignIn
import SwiftyBeaver

protocol FirstTimeWorker {
    func loginWithFacebook(token: String, completion: @escaping (Result<User, Error>) -> ())
    func loginWithGoogle(idToken: String, accessToken: String, completion: @escaping (Result<User, Error>) -> ())
}

class FirstTimeWorkerImpl: FirstTimeWorker {
    let facebookSignInWorker: SocialSignInWorker<FacebookProvider>
    let googleSignInWorker: SocialSignInWorker<GoogleProvider>
    
    init(
        facebookSignInWorker: SocialSignInWorker<FacebookProvider>,
        googleSignInWorker: SocialSignInWorker<GoogleProvider>        
    ) {
        self.facebookSignInWorker = facebookSignInWorker
        self.googleSignInWorker = googleSignInWorker
    }
    
    func loginWithFacebook(token: String, completion: @escaping (Result<User, Error>) -> ()) {
        facebookSignInWorker.login(token: FacebookToken(token: token), completion: completion)
    }
    
    func loginWithGoogle(idToken: String, accessToken: String, completion: @escaping (Result<User, Error>) -> ()) {
        googleSignInWorker.login(token: GoogleToken(idToken: idToken, accessToken: accessToken), completion: completion)
    }
}

class FakeFirstTimeWorker: FirstTimeWorker {
    func loginWithFacebook(token: String, completion: @escaping (Result<User, Error>) -> ()) {
        
    }
    
    func loginWithGoogle(idToken: String, accessToken: String, completion: @escaping (Result<User, Error>) -> ()) {
        
    }
}
